/*! jquery.objectForm v0.1.0 -jquery  created by StevenCJC Email:522702986@qq.com | (c) 2005, 2015 jquery.objectForm Foundation */!function($){function typesSplit(a){if("[]"==a||"array"==a)return"[]";if("{}"==a||"object"==a)return"{}";a||(a=[]),"string"==typeof a&&(a=a.replace(/\s/g,"").split(","));for(var b=[],c,d=0;d<a.length;d++)a[d]&&(a[d]=a[d].toString().replace(/\s/g,""))&&(c=a[d].split(":"),b.push({type:c[0],param:c[1]}));return b}function pickData(a){var b=[];return a.find("input,select,textarea").not("[disabled]").each(function(a,c){var d,e,f,g,h,i=$(this);f=typesSplit(i.attr("of-type")),g=i.attr("of-name"),g?"select"==this.tagName.toLowerCase()?this.multiple?(e=h=[],$(this).children(":selected").each(function(a,b){e.push(convert(this.value,f))})):h=convert(this.value,f):"radio"==this.type.toLowerCase()||"checkbox"==this.type.toLowerCase()?this.checked?h=convert(this.value,f):g=null:h=convert(this.value,f):(d=$(this).attr("of-define"))&&(-1==d.indexOf("=")&&(d=d+"="+(f.toString()||{})),h=a,g=d),g&&b.push({el:this,name:g,value:h,val:this.value||"",check:f&&f.length,types:f})}),b}function convert(a,b){for(var c=0;c<b.length;c++)switch(b[c].type){case"int":return parseInt(a)||0;case"number":return(a&&(a=a.replace(/,/g,"")).indexOf(".")>-1?parseFloat(a):parseInt(a))||0;case"float":return 0|parseFloat(a);case"bool":return!!a}return a.toString()}function filterDefine(a){for(var b={},c={},d,e,f,g,h,i=0;i<a.length;i++)h=a[i].name.split(/\[|\{|\.|\=/g),(d=a[i].name.indexOf("="))>-1&&(g=h[0],e=parseInt(a[i].value),c[g]||(c[g]=f={header:{},keys:{}}),f=c[g],f.header[e]=a[i].name,a[i]=null);for(var i=0;i<a.length;i++)a[i]&&(a[i].name.search(/\[|\{|\./g)>-1?c[a[i].name.split(/\[|\{|\./g)[0]].keys[i]=a[i].name:b[a[i].name]=a[i].value);return{object:b,group:c,obj:a}}function evalText(data){var object=data.object,group=data.group,obj=data.obj,text="",item,var_,shim_text;text="(function(object,src_obj){";for(var x in group){item=group[x];var i=0;for(var h in item.header)text+=0==i?'object["'+x+'"]=(function(){var '+item.header[h]+";":item.header[h]+";",i++;for(var k in item.keys)text+=item.keys[k]+"=src_obj["+k+"].value;";shim_text="";for(var h in item.header)item.header[h].indexOf("=[]")>-1&&(var_=item.header[h].replace(/\=\[\]/,""),shim_text=var_+"=shimArr("+var_+");"+shim_text);text+=shim_text+"return "+x+";})();"}text+="function shimArr(arr){if(arr&&arr.constructor==Array){var a=[];for(var x in arr)a.push(arr[x]);return a;}else return arr;}",text+="})(object,obj)";try{eval(text)}catch(e){throw console.error(text),"Err: please check out the index or lack of define"}}$.fn.objectForm=function(){var a=pickData(this),b=filterDefine(a);return evalText(b),b.object};var messages={required:"必选字段",remote:"请修正该字段",email:"请输入正确格式的电子邮件",url:"请输入合法的网址",date:"请输入合法的日期",dateISO:"请输入合法的日期 (ISO).",number:"请输入合法的数字","int":"只能输入整数",bool:"","float":"请填写带小数位的数字",creditcard:"请输入合法的信用卡号",accept:"请输入拥有合法后缀名的字符串",maxlength:"请输入一个 长度最多是 {0} 的字符串",minlength:"请输入一个 长度最少是 {0} 的字符串",rangelength:"请输入 一个长度介于 {0} 和 {1} 之间的字符串",range:"请输入一个介于 {0} 和 {1} 之间的值",max:"请输入一个最大为{0} 的值",min:"请输入一个最小为{0} 的值"},methods={required:function(a,b){return b.constructor==Array?b&&b.length>0:$.trim(b).length>0},email:function(a,b){return/^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))$/i.test(b)},url:function(a,b){return/^(https?|s?ftp):\/\/(((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:)*@)?(((\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5]))|((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?)(:\d*)?)(\/((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)+(\/(([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)*)*)?)?(\?((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|[\uE000-\uF8FF]|\/|\?)*)?(#((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|\/|\?)*)?$/i.test(b)},date:function(a,b){return!/Invalid|NaN/.test(new Date(b).toString())},dateISO:function(a,b){return/^\d{4}[\/\-]\d{1,2}[\/\-]\d{1,2}$/.test(b)},number:function(a,b){return/^-?(?:\d+|\d{1,3}(?:,\d{3})+)?(?:\.\d+)?$/.test(b)},"int":function(a,b){return/^\d+$/.test(b)},"float":function(a,b){return/^\d+\.\d+$/.test(b)},bool:function(a,b){return!0},creditcard:function(a,b){if(/[^0-9 \-]+/.test(b))return!1;var c=0,d=0,e=!1;b=b.replace(/\D/g,"");for(var f=b.length-1;f>=0;f--){var g=b.charAt(f);d=parseInt(g,10),e&&(d*=2)>9&&(d-=9),c+=d,e=!e}return c%10===0},minlength:function(a,b,c){var d=b.length;return d>=c},maxlength:function(a,b,c){var d=b.length;return c>=d},rangelength:function(a,b,c){c=c.split("-");var d=b.length;return d>=c[0]&&d<=c[1]},min:function(a,b,c){return b>=c},max:function(a,b,c){return c>=b},range:function(a,b,c){return c=c.split("-"),b>=c[0]&&b<=c[1]}};$.fn.objectFormValid=function(a){switch(a){case"destroy":return this.data("objectFormValid",null),void this.find("input,select,textarea").off(".objectFormValid");case"valid":for(var b=pickData(this),c=!0,d,e,f,g=0;g<b.length;g++)if(b[g].check){var h=validate(b[g].val,b[g].types,b[g]);if(d=signs[h.type],h.valid){e=clearSigns(b[g].el);for(var i=0;i<b[g].types.length;i++)f=b[g].types[i].type,signs.hasOwnProperty(f)&&signs[f]($(b[g].el),b[g].val,b[g].types[i].param,!0)}else e=errorSigns(b[g].el,h),d&&d($(b[g].el),b[g].val,h.param,h.valid,e),c=!1}return c}var j="";if(a&&a.events){var k=this;j=a.events.split(/\,|\s/g).join(".objectFormValid "),this.on(j,"input,select,textarea",function(){k.objectFormValid("valid")})}};var signs={},methodsExtended={};$.validExtend=function(a,b,c,d){d&&(massages[a]=d),b&&(methodsExtended[a]=b),c&&(signs[a]=c)};function validate(a,b,c){var d=!1;if(b&&b.length)for(var e=0;e<b.length;e++)if("required"==b[e].type&&(d=!0,!methods.required($(c.el),a))){var f={valid:!1,type:"required",param:void 0,value:a};return console.info(f),f}if(a&&b&&b.length)for(var e=0;e<b.length;e++)if(methods[b[e].type]&&!methods[b[e].type]($(c.el),a,b[e].param)){var f={valid:!1,type:b[e].type,param:b[e].param,value:a};return console.info(f),f}if(b&&b.length)for(var e=0;e<b.length;e++)if(methodsExtended[b[e].type]&&!methodsExtended[b[e].type]($(c.el),a,b[e].param)){var f={valid:!1,type:b[e].type,param:b[e].param,value:a};return console.info(f),f}return{valid:!0}}function clearSigns(a){if($(a).hasClass("error")){$(a).removeClass("error");var b=$(a).next("label.error");return b.length?(b.remove(),b):void 0}}function errorSigns(a,b){var c=makeLabel(b);return $(a).hasClass("error")&&clearSigns(a),$(a).addClass("error"),c?($(a).after(c),c):void 0}function makeLabel(a){var b=messages[a.type];if(b&&a.param){var c=a.param.split("-");b=b.replace(/\{\d\}/g,function(a){return c[parseInt(a.replace(/\{|\}/,""))]})}return b?$('<label class="error">'+b+"</label>"):void 0}}(jQuery||$);